<% include ../static/head.html %>
<body>
<% include ../static/topBar.html %>

<div class="am-cf admin-main">

    <% include ../static/leftMenu.html %>

    <div class=" admin-content">

        <div class="daohang">
           <!-- <ul>
                <li><a href="/admin/index"><button type="button" class="am-btn am-btn-default am-radius am-btn-xs"> 首页</button></a> </li>
                <li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">帮助中心<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
                <li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">奖金管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
                <li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">产品管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
            </ul>-->
        </div>

        <!--弹出框-->
        <div class="am-popup am-popup-inner" id="my-popup">
            <div class="am-popup-hd">
                <h4 class="am-popup-title">添加管理员</h4>
                <span data-am-modal-close
                      class="am-close">&times;</span> </div>
            <div class="am-popup-bd">
                <form class="am-form tjlanmu" id="addForm">
                    <!--<div class="am-form-group am-cf">
                        <div class="zuo">管理员ID：</div>
                        <div class="you">
                            <input type="number" class="am-input-sm" name="admin_id" placeholder="请输入ID" required="required">
                        </div>
                    </div>-->
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员名称：</div>
                        <div class="you">
                            <input type="text" class="am-input-sm" name="adminName" placeholder="请输入名称" required="required">
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员密码：</div>
                        <div class="you">
                            <!--<textarea class="" rows="2" id="doc-ta-1"></textarea>-->
                            <input type="password" class="am-input-sm" name="adminpwd" placeholder="请输入密码" required="required">
                        </div>
                    </div>
                    <!--<div class="am-form-group am-cf">
                        <div class="zuo">管理员图片：</div>
                        <div class="you" style="height: 45px;">
                            <input type="file" id="doc-ipt-file-1">
                            <p class="am-form-help">请选择要上传的文件...</p>
                        </div>
                    </div>-->
                    <div class="am-form-group am-cf">
                    <div class="zuo">管理员邮箱：</div>
                    <div class="you">
                        <!--<textarea class="" rows="2" id="doc-ta-1"></textarea>-->
                        <input type="email" class="am-input-sm" name="adminemail" placeholder="请输入邮箱" required="required">
                    </div>
                </div>
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员手机：</div>
                        <div class="you">
                            <!--<textarea class="" rows="2" id="doc-ta-1"></textarea>-->
                            <input type="tel" class="am-input-sm" name="adminphone" placeholder="请输入手机" required="required">
                        </div>
                    </div>

                    <div class="am-form-group am-cf">
                        <div class="zuo">状态：</div>
                        <div class="you" style="margin-top: 3px;">
                            <label class="am-checkbox-inline">
                                <input type="checkbox" value="option1">
                                显示 </label>
                            <label class="am-checkbox-inline">
                                <input type="checkbox" value="option2">
                                隐藏 </label>
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="you">
                            <p>
                                <button type="button" class="am-btn am-btn-success am-radius" id="addAdmin">提交</button>
                            </p>
                        </div>
                    </div>
                </form>

            </div>
        </div>

        <!--修改操作模态框-->

        <div class="am-popup am-popup-inner" id="my-popups">
            <div class="am-popup-hd">
                <h4 class="am-popup-title">修改管理员资料</h4>
                <span data-am-modal-close class="am-close">&times;</span> </div>
            <div class="am-popup-bd">
                <form class="am-form tjlanmu" id="changeForm">
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员ID：</div>
                        <div class="you">
                            <input type="number"  class="am-input-sm" name="admin_id" readonly>
                        </div>
                    </div>

                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员名称：</div>
                        <div class="you">
                            <input type="text" class="am-input-sm"  name="changeName">
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员密码：</div>
                        <div class="you">
                            <input type="password" class="am-input-sm" name="changePwd">
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员邮箱：</div>
                        <div class="you">
                            <input type="email" class="am-input-sm" name="changeEmail">
                        </div>
                    </div>
                    <!--<div class="am-form-group am-cf">
                        <div class="zuo">管理员图片：</div>
                        <div class="you" style="height: 45px;">
                            <input type="file" id="doc-ipt-file-1">
                            <p class="am-form-help">请选择要上传的文件...</p>
                        </div>
                    </div>-->
                    <div class="am-form-group am-cf">
                        <div class="zuo">管理员手机：</div>
                        <div class="you">
                            <input type="tel" class="am-input-sm" name="changePhone">
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="zuo">状态：</div>
                        <div class="you" style="margin-top: 3px;">
                            <label class="am-checkbox-inline">
                                <input type="checkbox" value="option1">
                                显示 </label>
                            <label class="am-checkbox-inline">
                                <input type="checkbox" value="option2">
                                隐藏 </label>
                        </div>
                    </div>
                    <div class="am-form-group am-cf">
                        <div class="you">
                            <p>
                                <button type="button" class="am-btn am-btn-success am-radius" id="changeAdmin">提交</button>
                            </p>
                        </div>
                    </div>
                </form>
            </div>
        </div>


        <!--两种弹出框结束-->



        <div class="admin-biaogelist">

            <div class="listbiaoti am-cf">
                <ul class="am-icon-users"> 管理员管理</ul>

                <dl class="am-icon-home" style="float: right;">当前位置： 首页 > <a href="#">管理员管理</a></dl>

                <dl>
                    <button type="button" class="am-btn am-btn-danger am-round am-btn-xs am-icon-plus" data-am-modal="{target: '#my-popup'}"> 手动添加管理员</button>
                </dl>
                <!--这里打开的是新页面-->
            </div>

            <form class="am-form am-g">
                <table width="100%" class="am-table am-table-bordered am-table-radius am-table-striped" id="myTable">
                    <thead>
                    <tr class="am-success">
                        <th class="table-check"><input type="checkbox" /></th>

                        <th class="table-id" >ID</th>
                        <th class="table-title" >管理员名称</th>
                        <th class="table-author am-hide-sm-only">管理员密码</th>
                        <th class="table-author am-hide-sm-only" >管理员邮箱</th>
                        <th class="table-author am-hide-sm-only" >管理员手机</th>
                        <th width="130px" class="table-set">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <% for (var index in adminInfo) {%>
                    <tr>
                        <td><input type="checkbox" /></td>

                        <td><%- adminInfo[index].admin_id -%></td>
                        <td><%- adminInfo[index].name -%></td>
                        <td><%- adminInfo[index].password -%></td>
                        <td class="am-hide-sm-only"><%- adminInfo[index].email -%></td>
                        <td class="am-hide-sm-only"><%- adminInfo[index].phone -%></td>
                        <td>



                            <div class="am-btn-toolbar">
                                <div class="am-btn-group am-btn-group-xs">
                                    <!--<button id="btn_del_<%-adminInfo[index].admin_id%>" type="button" class="change am-btn am-btn-default am-btn-xs am-text-secondary am-round"   title="修改"><span class="am-icon-pencil-square-o"></span></button>-->
                                    <!--<button class="am-btn am-btn-default am-btn-xs am-text-success am-round"><span class="am-icon-search" title="查看详情"></span> </button>-->
                                    <button  type="button" data-admin-id="<%- adminInfo[index].admin_id -%>" data-admin-name="<%- adminInfo[index].name -%>" data-admin-password="<%- adminInfo[index].password -%>" data-admin-email="<%- adminInfo[index].email -%>"  data-admin-phone="<%- adminInfo[index].phone -%>" class="change am-btn am-btn-default am-btn-xs am-text-secondary am-round"   title="修改"><span class="am-icon-pencil-square-o"></span></button>
                                    <button  type="button" id="btn_del_<%-adminInfo[index].admin_id%>"  class="delete am-btn am-btn-default am-btn-xs am-text-danger am-round"  title="删除"><span class="am-icon-trash-o" ></span></button>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <% } %>
                    </tbody>
                </table>

                <div class="am-btn-group am-btn-group-xs">
                    <button type="button" class="am-btn am-btn-default"><span class="am-icon-trash-o"></span> 删除</button>
                </div>

                <ul class="am-pagination am-fr">
                    <li class="am-disabled"><a href="#">«</a></li>
                    <li class="am-active"><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                    <li><a href="#">5</a></li>
                    <li><a href="#">»</a></li>
                </ul>




                <hr />

            </form>


            <div class="foods">
                <ul>
                    版权所有@2015
                </ul>
                <dl>
                    <a href="" title="返回头部" class="am-icon-btn am-icon-arrow-up"></a>
                </dl>
            </div>
        </div>

    </div>



</div>

<script>
    $('#addAdmin').click(function(){
        var data = $('#addForm').serialize();
        console.log(data);

        $.ajax({
            url:"/admin/privilege/addadmin",
            method:"post",
            data:data,
            success: function(msg){
//    			console.log(msg);
                switch (msg.data){
                    case -1:
                        _toastr("已经存在同名管理员！","top-right","info",false);
                        break;
                    case 1:
                        location.reload(true);
                        break;
                }
            }

        })

    })
    $(".change").click(function (event) {
        $("input[name=admin_id]").val($(event.currentTarget).attr("data-admin-id"));
        $("input[name=changeName]").val($(event.currentTarget).attr("data-admin-name"));
        $("input[name=changePwd]").val($(event.currentTarget).attr("data-admin-password"));
        $("input[name=changeEmail]").val($(event.currentTarget).attr("data-admin-email"));
        $("input[name=changePhone]").val($(event.currentTarget).attr("data-admin-phone"));
        $("#my-popups").modal();
    })

    $('#changeAdmin').click(function () {
        var data = $('#changeForm').serialize();
        console.log(data);

        $.ajax({
            url:"/admin/privilege/changeadmin",
            method:"post",
            data:data,
            success: function (msg) {
                //console.log(msg);
                switch (msg.data){
                    case -1:
                        _toastr("不存在该管理员！","top-right","info",false);
                        break;
                    case 1:
                        location.reload(true);
                        break;
                }
            }
        })

    })

     $(".delete").click(function () {
         var admin_id_str = this.id;
         var admin_id = admin_id_str.substr(('btn_del_').length);

         $.ajax({
             url:"/admin/privilege/deleteadmin",
             method:"post",
             data:{admin_id:admin_id}
         });
     })




</script>




<!--[if (gte IE 9)|!(IE)]><!-->
<script src="/static/admin/js/amazeui.min.js"></script>
<!--<![endif]-->



</body>
</html>